<%- include('./partials/header') %>

<% if(success.length>0){ %>
    <div id="successMessage" class="absolute top-5 left-1/2 -translate-x-1/2 -translate-y-1/2 p-3 rounded-md bg-green-500">
        <span class="inline-block mt-1 mb-1 text-white">
            <%= success %>
        </span>
    </div>
    <% } %>
    <div class="flex min-h-screen bg-gray-100">
        <div class="w-64 bg-white shadow-md p-6 flex flex-col">
            <h2 class="text-2xl font-semibold mb-6">Shop</h2>
            
            <div class="mb-8">
                <h3 class="text-lg font-medium mb-2">Sort By</h3>
                <form action="/shop" method="GET">
                    <select class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500" name="sortby" onchange="this.form.submit()">
                        <option value="">Select an option</option>
                        <option value="lowprice">Low to High Price</option>
                        <option value="highprice">High to Low Price</option>
                        <option value="maxdiscount">Maximum Discount</option>
                    </select>
                </form>
            </div>
            
            <div class="mt-7">
                <img src="/images/img/about/a5.jpg" alt="Shop Image" class="w-full h-auto rounded-md">
            </div>
            <div class="mt-11">
                <img src="/images/img/about/shoppingman.jpeg" alt="Shop Image" class="w-full h-auto rounded-md">
            </div>
            <div class="mt-11">
                <img src="/images/img/about/shopfamily.png" alt="Shop Image" class="w-full h-auto rounded-md">
            </div>
            <div class="mt-9">
                <img src="/images/img/about/shopgirl.png" alt="Shop Image" class="w-full h-auto rounded-md">
            </div>
            <div class="mt-5 ml-12 text-green-500 font-extralight">Urbanic@2024</div>
        </div>
    
        <div class="flex-1 p-8">
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <% products.forEach(function(product){ %>
                    <div class="bg-white rounded-lg shadow-md overflow-hidden">
                        <div class="h-64 flex items-center justify-center" style="background-color: <%= product.bgcolor %>;">
                            <img class="h-48 object-contain" src="data:image/jpeg;base64,<%= product.image.toString('base64') %>" alt="<%= product.name %>">
                        </div>
                        <div class="p-4" style="background-color: <%= product.panelcolor %>; color: <%= product.textcolor %>;">
                            <h3 class="text-lg font-semibold mb-2"><%= product.name %></h3>
                            <div class="flex justify-between items-center">
                                <h4 class="text-xl font-bold">â‚¹ <%= product.price %></h4>
                                <div class="flex items-center space-x-2">
                                    <% if (product.discount != 0) { %>
                                        <span class="bg-red-500 text-white px-2 py-1 rounded-full text-xs font-semibold">-<%= product.discount %>%</span>
                                    <% } %>
                                    <a href="/addtocart/<%= product._id %>" class="bg-white text-gray-800 rounded-full p-2 hover:bg-gray-100 transition">
                                        <i class="ri-add-line"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                <% }) %>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var errorMessage = document.getElementById('successMessage');
            if (errorMessage) {
                setTimeout(function() {
                    errorMessage.style.display = 'none';
                }, 5000); 
            }
        });
    </script>
</body>

</html>